@page "/"
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.Web
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager Navigation
@inject AppSettingsState AppSettings
@inject ThemeState ThemeState
@inject IJSRuntime JSRuntime
@implements IDisposable

<PageTitle>@AppSettings.Settings.SiteName - @AppSettings.Settings.SiteDescription</PageTitle>

<div class="bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-black text-gray-900 dark:text-white transition-colors duration-300">

    <!-- Enhanced Toast Container -->
    @if (toasts.Any())
    {
        <div class="fixed bottom-4 right-4 z-50 space-y-2">
            @foreach (var toast in toasts.Where(t => t.IsVisible))
            {
                <div class="@GetToastClasses(toast) toast-slide-in">
                    <div class="flex items-center justify-between">
                        <span class="flex items-center space-x-2">
                            <span>@GetToastIcon(toast.Type)</span>
                            <span>@toast.Message</span>
                        </span>
                        <button class="ml-4 text-white hover:text-gray-200 focus:outline-none transition-colors" 
                                @onclick="@(() => RemoveToast(toast.Id))"
                                aria-label="Close notification">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            }
        </div>
    }

    <!-- Improved Loading Overlay -->
    @if (isLoading)
    {
        <div class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 backdrop-blur-sm">
            <div class="bg-white dark:bg-gray-800 rounded-xl p-8 flex items-center space-x-4 shadow-2xl border border-gray-200 dark:border-gray-700">
                <div class="spinner"></div>
                <span class="text-xl font-semibold">@loadingMessage</span>
            </div>
        </div>
    }

    <!-- Hero Section - Enhanced with Animated Background -->
    <section id="hero" class="min-h-screen flex items-center justify-center pt-20 px-6 relative overflow-hidden">
        <!-- Animated Gradient Background -->
        <div class="absolute inset-0 bg-gradient-to-br from-primary/5 via-accent/5 to-primary/5 animate-gradient-slow"></div>

        <!-- Floating Particles Effect -->
        <div class="absolute inset-0">
            <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-primary/10 rounded-full blur-3xl animate-float-slow"></div>
            <div class="absolute bottom-1/3 right-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl animate-float-slower"></div>
            <div class="absolute top-1/2 right-1/3 w-48 h-48 bg-primary/10 rounded-full blur-2xl animate-float"></div>
        </div>

        <div class="text-center max-w-6xl mx-auto animate-fade-in relative z-10">
            <div class="mb-6 animate-slide-down">
                <span class="inline-block px-6 py-3 bg-primary text-white rounded-full text-sm font-semibold uppercase tracking-wide shadow-lg">
                    Welcome to the Future of Healthcare üè•
                </span>
            </div>
            
            <h1 class="text-4xl md:text-6xl lg:text-8xl font-black mb-8 animate-slide-up leading-tight">
                <span class="gradient-text bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent">
                    @AppSettings.Settings.SiteName
                </span>
                <br>
                <span class="text-gray-800 dark:text-white text-xl lg:text-5xl">@AppSettings.Settings.SiteDescription</span>
            </h1>
            
            <p class="text-xl md:text-2xl text-gray-600 dark:text-gray-300 mb-12 animate-slide-up max-w-4xl mx-auto leading-relaxed">
                An AI-Powered Healthcare Management Platform revolutionizing the way you interact with medical services.
            </p>
            
            <div class="flex flex-col sm:flex-row gap-6 justify-center items-center animate-slide-up">
                @AppButton("Primary", "‚ú®", "Get Started", EventCallback.Factory.Create(this, GetStarted), isLoading, "Large")
                @AppButton("Secondary", "üöÄ", "Explore Features", EventCallback.Factory.Create(this, () => ScrollToSection("features")), false, "Large")
            </div>

            <!-- Enhanced Stats Section with Theme-Aware Styling -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-16 animate-fade-in-up">
                @StatsCard("24/7", "Emergency Support", "üö®")
                @StatsCard("10K+", "Healthcare Providers", "üë®‚Äç‚öïÔ∏è")
                @StatsCard("99.9%", "Uptime Guarantee", "‚úì")
            </div>

            <!-- Dynamic Contact Info from Admin Settings -->
            @if (!string.IsNullOrEmpty(AppSettings.Settings.ContactEmail) || !string.IsNullOrEmpty(AppSettings.Settings.ContactPhone))
            {
                <div class="mt-12 mb-12 p-6 bg-white/10 dark:bg-gray-800/30 backdrop-blur-lg rounded-2xl border border-primary/20 animate-fade-in-up">
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-6 text-gray-800 dark:text-gray-200">
                        @if (!string.IsNullOrEmpty(AppSettings.Settings.ContactEmail))
                        {
                            <a href="mailto:@AppSettings.Settings.ContactEmail" class="flex items-center space-x-2 hover:text-primary transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                </svg>
                                <span>@AppSettings.Settings.ContactEmail</span>
                            </a>
                        }
                        @if (!string.IsNullOrEmpty(AppSettings.Settings.ContactPhone))
                        {
                            <a href="tel:@AppSettings.Settings.ContactPhone" class="flex items-center space-x-2 hover:text-accent transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                </svg>
                                <span>@AppSettings.Settings.ContactPhone</span>
                            </a>
                        }
                    </div>
                </div>
            }
        </div>
    </section>

    <!-- Features Section - Simplified and Optimized -->
    <section id="features" class="py-20 px-6 bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
        <div class="container mx-auto">
            @SectionHeader("Features Provided", "Discover our comprehensive suite of healthcare management tools.", "üöÄ")
            
            <div class="grid md:grid-cols-3 gap-8 mt-12">
                @FeatureCard("Admin Panel", "cyan", "üë•", adminFeatures, EventCallback.Factory.Create(this, () => HandleFeatureClick("Admin Panel")))
                @FeatureCard("Doctor Panel", "pink", "üë®‚Äç‚öïÔ∏è", doctorFeatures, EventCallback.Factory.Create(this, () => HandleFeatureClick("Doctor Panel")))
                @FeatureCard("Patient Panel", "green", "üë§", patientFeatures, EventCallback.Factory.Create(this, () => HandleFeatureClick("Patient Panel")))
            </div>
        </div>
    </section>

    <!-- Amazing Features Section - Streamlined -->
    <section class="py-20 px-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900">
        <div class="container mx-auto">
            @SectionHeader("Amazing Features", "Experience cutting-edge healthcare technology.", "‚ú®")
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mt-12">
                @ServiceCard("Smart Records Management", "AI-powered organization and analysis of medical records.", "üìÑ", "primary", "Explore Records", EventCallback.Factory.Create(this, ManageDocuments))
                @ServiceCard("Global Healthcare Network", "Connect with certified healthcare professionals worldwide.", "üåç", "purple", "Join Network", EventCallback.Factory.Create(this, JoinCommunity))
                @ServiceCard("Intelligent Scheduling", "AI-driven appointment optimization with conflict resolution.", "üìÖ", "blue", "Smart Scheduling", EventCallback.Factory.Create(this, ScheduleAppointment))
            </div>

            <!-- Emergency and Telemedicine Section - Enhanced -->
            <div class="grid md:grid-cols-2 gap-8 mt-16">
                @EmergencyCard(EventCallback.Factory.Create(this, HandleEmergencyMessages), EventCallback.Factory.Create(this, HospitalAssistance))
                @TelemedicineCard(EventCallback.Factory.Create(this, StartVideoConsultation), EventCallback.Factory.Create(this, StartAudioCall))
            </div>
        </div>
    </section>

    <!-- CTA Section - Optimized -->
    <section class="py-24 px-6 bg-gradient-to-br dark:from-gray-900 dark:to-black relative overflow-hidden">
        <div class="container mx-auto text-center relative z-10">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-4xl md:text-6xl lg:text-7xl font-black mb-8 leading-tight">
                    Transform Health with<br>
                    <span class="gradient-text bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent">
                        @AppSettings.Settings.SiteName
                    </span>
                </h2>
                <p class="text-xl md:text-2xl text-gray-600 dark:text-gray-300 mb-12 leading-relaxed">
                    Join thousands who trust our platform for comprehensive healthcare management.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-6 justify-center mb-16">
                    @AppButton("Primary", "üöÄ", "Start Your Health Journey", EventCallback.Factory.Create(this, StartHealthJourney), false, "Large")
                    @AppButton("Secondary", "", "Contact Support", EventCallback.Factory.Create(this, () => HandleNavigation("Contact")), false, "Large")
                </div>

                <!-- Trust Badges - Optimized -->
                @TrustBadges
            </div>
        </div>
    </section>
</div>

@code {
    #region State Management
    private readonly List<ToastItem> toasts = new();
    private int toastIdCounter = 0;
    private bool isUserAuthenticated = false;
    private bool isLoading = false;
    private string loadingMessage = "Loading...";
    private Timer? toastCleanupTimer;
    #endregion

    #region Feature Data
    private readonly List<string> adminFeatures = new()
    {
        "User Management: Comprehensive role-based access control",
        "Analytics Dashboard: Real-time system insights",
        "Security Management: Advanced compliance monitoring",
        "System Configuration: Manage system settings and configurations, including security policies and data retention rules.",
        "Audit Logs: Detailed activity tracking for accountability"
    };

    private readonly List<string> doctorFeatures = new()
    {
        "Patient Records: Secure medical history access",
        "AI Diagnostics: Intelligent treatment recommendations",
        "Telemedicine: Integrated video consultations",
        "Appointment Management: Efficient scheduling and reminders",
        "Prescription Management: E-prescribing with drug interaction checks"
    };

    private readonly List<string> patientFeatures = new()
    {
        "Health Records: Personal data with smart insights",
        "Appointment Booking: Seamless scheduling system",
        "Health Monitoring: Continuous tracking and recommendations",
        "Telehealth Services: Virtual consultations with healthcare providers",
        "Medication Reminders: AI-driven alerts for medication adherence"
    };
    #endregion

    #region Lifecycle Methods
    protected override async Task OnInitializedAsync()
    {
        // Subscribe to theme changes for dynamic reactivity
        ThemeState.OnChange += OnThemeChanged;
        AppSettings.OnChange += OnSettingsChanged;

        await CheckAuthenticationState();
        await ShowWelcomeMessage();
        InitializeToastCleanup();
    }

    private void OnThemeChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    private void OnSettingsChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await InitializeJavaScriptInterop();
        }
    }
    #endregion

    #region Authentication Management
    private async Task CheckAuthenticationState()
    {
        try
        {
            var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
            isUserAuthenticated = authState.User?.Identity?.IsAuthenticated == true;
            
            if (isUserAuthenticated && authState.User?.Identity?.Name != null)
            {
                await ShowInfo($"Welcome back, {authState.User.Identity.Name}!");
            }
        }
        catch (Exception ex)
        {
            await HandleError($"Authentication check failed: {ex.Message}");
        }
    }
    #endregion

    #region Toast Management - Optimized
    private void InitializeToastCleanup()
    {
        toastCleanupTimer = new Timer(_ =>
        {
            InvokeAsync(() =>
            {
                var expiredToasts = toasts.Where(t => DateTime.Now - t.CreatedAt > TimeSpan.FromSeconds(5)).ToList();
                foreach (var toast in expiredToasts)
                {
                    toasts.Remove(toast);
                }
                if (expiredToasts.Any()) StateHasChanged();
            });
        }, null, TimeSpan.FromSeconds(1), TimeSpan.FromSeconds(1));
    }

    private Task ShowToast(string message, ToastType type = ToastType.Info, int duration = 3000)
    {
        var toast = new ToastItem
        {
            Id = ++toastIdCounter,
            Message = message,
            Type = type,
            CreatedAt = DateTime.Now,
            IsVisible = true
        };

        toasts.Add(toast);
        StateHasChanged();

        _ = Task.Run(async () =>
        {
            await Task.Delay(duration);
            await RemoveToast(toast.Id);
        });

        return Task.CompletedTask;
    }

    private async Task RemoveToast(int toastId)
    {
        await InvokeAsync(() =>
        {
            var toast = toasts.FirstOrDefault(t => t.Id == toastId);
            if (toast != null)
            {
                toasts.Remove(toast);
                StateHasChanged();
            }
        });
    }

    private async Task ShowSuccess(string message, int duration = 3000) => await ShowToast(message, ToastType.Success, duration);
    private async Task ShowError(string message, int duration = 4000) => await ShowToast(message, ToastType.Error, duration);
    private async Task ShowInfo(string message, int duration = 3000) => await ShowToast(message, ToastType.Info, duration);
    private async Task ShowWarning(string message, int duration = 4000) => await ShowToast(message, ToastType.Warning, duration);
    #endregion

    #region Navigation and Feature Handlers - Streamlined
    private async Task GetStarted()
    {
        if (isUserAuthenticated)
        {
            await NavigateToDashboard();
        }
        else
        {
            await ShowSuccess("Welcome! Please log in to get started. üéâ");
            await HandleLogin();
        }
    }

    private async Task HandleLogin()
    {
        if (isUserAuthenticated)
        {
            await ShowInfo("You are already logged in!");
            return;
        }

        await ShowInfo("Redirecting to login...");
        await Task.Delay(1000);
        Navigation.NavigateTo("/login");
    }

    private async Task NavigateToDashboard()
    {
        try
        {
            var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
            var role = authState.User?.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value ?? "Patient";
            
            var dashboardUrl = role switch
            {
                "Admin" => "/admin/dashboard",
                "Doctor" => "/doctor/dashboard",
                _ => "/patient/dashboard"
            };

            await ShowInfo($"Redirecting to {role} dashboard...");
            Navigation.NavigateTo(dashboardUrl);
        }
        catch (Exception ex)
        {
            await ShowError($"Navigation failed: {ex.Message}");
        }
    }

    // Consolidated feature handlers
    private async Task HandleFeatureClick(string featureName) =>
        await ShowInfo($"{featureName} - Feature coming soon! üöÄ");

    private async Task ManageDocuments() =>
        await ShowInfo("üìÑ Smart Records Management coming soon!");

    private async Task JoinCommunity() =>
        await ShowInfo("üåç Joining Global Healthcare Network!");

    private async Task ScheduleAppointment() =>
        await ShowInfo("üìÖ Intelligent Scheduling System coming soon!");

    private async Task HandleEmergencyMessages() =>
        await ShowWarning("üö® Emergency Alert System activated!", 4000);

    private async Task HospitalAssistance() =>
        await ShowInfo("üìç Locating nearest hospitals...");

    private async Task StartVideoConsultation() =>
        await ShowInfo("üìπ Initializing secure video consultation...");

    private async Task StartAudioCall() =>
        await ShowInfo("üîä Starting encrypted audio consultation...");

    private async Task StartHealthJourney()
    {
        await ShowSuccess("üåü Your health journey begins now!");
        if (!isUserAuthenticated)
        {
            await Task.Delay(2000);
            await HandleLogin();
        }
    }

    private async Task HandleNavigation(string section) =>
        await ShowInfo($"üìç Navigating to {section}...");
    #endregion

    #region Utility Methods - Optimized
    private async Task ScrollToSection(string sectionId)
    {
        try
        {
            await JSRuntime.InvokeVoidAsync("scrollToSection", sectionId);
        }
        catch
        {
            await ShowInfo($"Navigating to {sectionId} section...");
        }
    }

    private string GetToastClasses(ToastItem toast)
    {
        var baseClasses = "max-w-sm p-4 rounded-xl shadow-2xl transition-all duration-300 border backdrop-blur-sm";
        var typeClasses = toast.Type switch
        {
            ToastType.Success => "bg-green-500/95 text-white border-green-400",
            ToastType.Error => "bg-red-500/95 text-white border-red-400",
            ToastType.Info => "bg-blue-500/95 text-white border-blue-400",
            ToastType.Warning => "bg-yellow-500/95 text-white border-yellow-400",
            _ => "bg-gray-800/95 text-white border-gray-600"
        };
        
        return $"{baseClasses} {typeClasses}";
    }

    private string GetToastIcon(ToastType type) => type switch
    {
        ToastType.Success => "‚úÖ",
        ToastType.Error => "‚ùå",
        ToastType.Info => "‚ÑπÔ∏è",
        ToastType.Warning => "‚ö†Ô∏è",
        _ => "üì¢"
    };

    private async Task ShowWelcomeMessage()
    {
        await Task.Delay(1500);
        await ShowSuccess($"Welcome to {AppSettings.Settings.SiteName}! üè•‚ú®");
    }

    private async Task InitializeJavaScriptInterop()
    {
        try
        {
            await JSRuntime.InvokeVoidAsync("console.log", $"MediChat AI initialized at {DateTime.Now:HH:mm:ss}");
        }
        catch
        {
            // JavaScript interop failed, continue without it
        }
    }

    private async Task HandleError(string errorMessage)
    {
        await ShowError($"Error: {errorMessage}");
        Console.WriteLine($"Application error: {errorMessage} at {DateTime.Now}");
    }
    #endregion

    #region Reusable Component Methods
    private RenderFragment StatsCard(string title, string description, string icon = "") =>
    @<div class="bg-white/10 dark:bg-gray-800/30 backdrop-blur-md rounded-2xl p-6 border border-white/20 hover:border-primary dark:hover:border-accent transition-all duration-300 hover:scale-105 group">
        <div class="flex items-center justify-between mb-2">
            <div class="text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">@title</div>
            @if (!string.IsNullOrEmpty(icon))
            {
                <div class="text-3xl group-hover:scale-110 transition-transform">@icon</div>
            }
        </div>
        <div class="text-gray-600 dark:text-gray-300 font-medium">@description</div>
    </div>;

    private RenderFragment SectionHeader(string title, string subtitle, string icon) =>
    @<div class="text-center mb-16">
        <h2 class="text-4xl md:text-5xl font-bold text-primary dark:text-accent mb-4">
            <span class="text-3xl">@icon</span> @title <span class="text-3xl">@icon</span>
        </h2>
        <p class="text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
            @subtitle
        </p>
    </div>;

    private RenderFragment AppButton(string type, string icon, string text, EventCallback onClick, bool isDisabled = false, string size = "Normal") =>
    @<button class="@GetButtonClasses(type, size) group" 
            @onclick="onClick" 
            disabled="@isDisabled">
        <span class="flex items-center space-x-2">
            <span>@text</span>
            @if (!string.IsNullOrEmpty(icon))
            {
                <span class="text-xl">@icon</span>
            }
        </span>
    </button>;

    private RenderFragment FeatureCard(string title, string color, string icon, List<string> features, EventCallback onClick) =>
    @<div class="relative rounded-2xl p-8 cursor-pointer overflow-hidden bg-white/80 dark:bg-gray-800/50 backdrop-blur-md border-2 border-transparent hover:transform hover:scale-105 transition-all duration-500 group shadow-lg hover:shadow-2xl"
         @onclick="onClick">
        
        <div class="absolute inset-0 rounded-2xl @GetBorderGradient(color) opacity-40 dark:opacity-60 blur-sm group-hover:opacity-60 transition-opacity duration-300"></div>
        <div class="absolute inset-[2px] rounded-2xl bg-white/95 dark:bg-gray-900/95 backdrop-blur-md"></div>
        
        <div class="relative z-10">
            <div class="h-48 rounded-xl mb-6 flex items-center justify-center @GetBackgroundGradient(color) transition-all duration-300">
                <div class="text-6xl animate-pulse">@icon</div>
            </div>
            
            <h3 class="text-2xl font-bold mb-4 text-gray-900 dark:text-white">@title</h3>
            
            <div class="space-y-3 text-sm">
                @foreach (var feature in features)
                {
                    var parts = feature.Split(':');
                    <div>
                        <span class="@GetFeatureTextColor(color) font-semibold">@parts[0]:</span>
                        <span class="text-gray-700 dark:text-gray-300">@parts[1]</span>
                    </div>
                }
            </div>
        </div>
    </div>;

    private RenderFragment ServiceCard(string title, string description, string icon, string color, string buttonText, EventCallback onClick) =>
    @<div class="bg-white dark:bg-gray-800 rounded-2xl p-8 hover-card shadow-xl border border-gray-200 dark:border-gray-700 hover:border-@(GetServiceColorClass(color))-300 dark:hover:border-@(GetServiceColorClass(color))-600 transition-all duration-300">
        <div class="flex items-center mb-6">
            <div class="w-14 h-14 bg-gradient-to-br from-@(GetServiceColorClass(color))-400 to-@(GetServiceColorClass(color))-600 rounded-xl flex items-center justify-center mr-4 shadow-lg">
                <div class="text-3xl">@icon</div>
            </div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">@title</h3>
        </div>
        
        <p class="text-gray-600 dark:text-gray-300 mb-6 leading-relaxed">
            @description
        </p>
        
        <button class="w-full bg-@(GetServiceColorClass(color))-500 hover:bg-@(GetServiceColorClass(color))-600 text-white hover:text-@(GetServiceColorClass(color)) hover:border hover:border-@(GetServiceColorClass(color)) py-3 rounded-lg font-semibold transition-colors focus:outline-none focus:ring-4 focus:ring-@(GetServiceColorClass(color))-200" 
                @onclick="onClick">
            ‚úì @buttonText
        </button>
    </div>;

    private RenderFragment EmergencyCard(EventCallback onEmergencyClick, EventCallback onHospitalClick) =>
    @<div class="bg-gradient-to-br from-accent to-accent rounded-3xl p-10 text-white hover-card shadow-2xl relative overflow-hidden group">
        <div class="absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full -translate-y-20 translate-x-20"></div>
        <div class="absolute inset-0 bg-gradient-to-r from-transparent to-accent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        
        <div class="relative z-10">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h3 class="text-4xl font-bold mb-3 tracking-tight">EMERGENCY</h3>
                    <p class="text-xl opacity-90 flex items-center space-x-2">
                        <span class="animate-pulse">üö®</span>
                        <span>Instant Response System</span>
                    </p>
                </div>
                <div class="w-28 h-28 bg-white/20 rounded-2xl flex items-center justify-center animate-pulse shadow-2xl border border-white/30">
                    <svg class="w-16 h-16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                </div>
            </div>
            
            <p class="mb-8 opacity-95 text-lg leading-relaxed">
                Advanced emergency response system with GPS tracking, instant hospital location, and automated alert dispatch.
            </p>
            
            <div class="flex flex-col sm:flex-row gap-4">
                <button class="flex-1 bg-white text-red-600 px-6 py-4 rounded-xl font-bold hover:bg-red-50 transition-colors shadow-lg focus:outline-none focus:ring-4 focus:ring-white/30"
                        @onclick="onEmergencyClick">
                    <span class="flex items-center justify-center space-x-2">
                        <span>üö®</span>
                        <span>Emergency Alert</span>
                    </span>
                </button>
                
                <button class="flex-1 border-2 border-white px-6 py-4 rounded-xl font-bold hover:bg-white hover:text-red-600 transition-all shadow-lg focus:outline-none focus:ring-4 focus:ring-white/30"
                        @onclick="onHospitalClick">
                    <span class="flex items-center justify-center space-x-2">
                        <span>üìç</span>
                        <span>Find Hospitals</span>
                    </span>
                </button>
            </div>
        </div>
    </div>;

    private RenderFragment TelemedicineCard(EventCallback onVideoClick, EventCallback onAudioClick) =>
    @<div class="bg-gradient-to-br from-primary to-primary rounded-3xl p-10 text-white hover-card shadow-2xl relative overflow-hidden group">
        <div class="absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full -translate-y-20 translate-x-20"></div>
        <div class="absolute inset-0 bg-gradient-to-r from-transparent to-primary opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        
        <div class="relative z-10">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h3 class="text-4xl font-bold mb-3 tracking-tight">Telemedicine</h3>
                    <p class="text-xl opacity-90 flex items-center space-x-2">
                        <span class="animate-pulse">üë®‚Äç‚öïÔ∏è</span>
                        <span>Virtual Healthcare</span>
                    </p>
                </div>
                <div class="w-28 h-28 bg-white/20 rounded-2xl flex items-center justify-center animate-pulse shadow-2xl border border-white/30">
                    <svg class="w-16 h-16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                    </svg>
                </div>
            </div>
            
            <p class="mb-8 opacity-95 text-lg leading-relaxed">
                High-definition video consultations with secure data transmission and integrated diagnostic tools.
            </p>
            
            <div class="flex flex-col sm:flex-row gap-4">
                <button class="flex-1 bg-white text-purple-600 px-6 py-4 rounded-xl font-bold hover:bg-purple-50 transition-colors shadow-lg focus:outline-none focus:ring-4 focus:ring-white/30"
                        @onclick="onVideoClick">
                    <span class="flex items-center justify-center space-x-2">
                        <span>üìπ</span>
                        <span>Start Video Call</span>
                    </span>
                </button>
                
                <button class="flex-1 border-2 border-white px-6 py-4 rounded-xl font-bold hover:bg-white hover:text-purple-600 transition-all shadow-lg focus:outline-none focus:ring-4 focus:ring-white/30"
                        @onclick="onAudioClick">
                    <span class="flex items-center justify-center space-x-2">
                        <span>üîä</span>
                        <span>Audio Consultation</span>
                    </span>
                </button>
            </div>
        </div>
    </div>;

    private RenderFragment TrustBadges =>
    @<div class="flex flex-wrap justify-center items-center gap-8 opacity-70">
        <div class="flex items-center space-x-2">
            <svg class="w-6 h-6 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"></path>
            </svg>
            <span class="font-semibold">HIPAA Compliant</span>
        </div>
        <div class="flex items-center space-x-2">
            <svg class="w-6 h-6 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z"></path>
            </svg>
            <span class="font-semibold">256-bit SSL Encryption</span>
        </div>
        <div class="flex items-center space-x-2">
            <svg class="w-6 h-6 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span class="font-semibold">ISO 27001 Certified</span>
        </div>
    </div>;
    #endregion

    #region Helper Methods
    private string GetButtonClasses(string type, string size = "Normal")
    {
        var baseClasses = "font-bold rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4";
        var sizeClasses = size switch
        {
            "Large" => "px-12 py-6 text-xl",
            _ => "px-10 py-5 text-xl"
        };
        var typeClasses = type switch
        {
            "Primary" => "bg-gradient-to-r from-primary to-accent text-white hover:shadow-2xl focus:ring-primary",
            "Secondary" => "border-2 border-primary text-black dark:text-white hover:bg-primary hover:text-white focus:ring-primary",
            _ => "bg-gray-500 text-white hover:bg-gray-600 focus:ring-gray-200"
        };
        
        return $"{baseClasses} {sizeClasses} {typeClasses}";
    }

    // All feature cards now use theme colors (primary and accent) for consistent branding
    private string GetBorderGradient(string color) =>
        "bg-gradient-to-r from-primary via-accent to-primary";

    // Theme-aware background gradients - all use primary/accent colors with varying opacity
    private string GetBackgroundGradient(string color) => color switch
    {
        "cyan" => "bg-gradient-to-br from-primary/10 to-accent/20 dark:from-primary/5 dark:to-accent/10 group-hover:from-primary/20 group-hover:to-accent/30 dark:group-hover:from-primary/10 dark:group-hover:to-accent/20",
        "pink" => "bg-gradient-to-br from-accent/10 to-primary/20 dark:from-accent/5 dark:to-primary/10 group-hover:from-accent/20 group-hover:to-primary/30 dark:group-hover:from-accent/10 dark:group-hover:to-primary/20",
        "green" => "bg-gradient-to-br from-primary/10 to-accent/20 dark:from-primary/5 dark:to-accent/10 group-hover:from-primary/20 group-hover:to-accent/30 dark:group-hover:from-primary/10 dark:group-hover:to-accent/20",
        _ => "bg-gradient-to-br from-accent/10 to-primary/20 dark:from-accent/5 dark:to-primary/10 group-hover:from-accent/20 group-hover:to-primary/30 dark:group-hover:from-accent/10 dark:group-hover:to-primary/20"
    };

    // All feature text now uses theme primary color for consistency
    private string GetFeatureTextColor(string color) =>
        "text-primary dark:text-accent";

    // Service cards now use theme colors (primary/accent) instead of hardcoded colors
    private string GetServiceColorClass(string color) => color switch
    {
        "purple" => "primary",
        "blue" => "primary",
        "green" => "accent",
        "red" => "accent",
        _ => "primary"
    };
    #endregion

    #region Models and Enums
    public record ToastItem
    {
        public int Id { get; set; }
        public string Message { get; set; } = "";
        public ToastType Type { get; set; }
        public DateTime CreatedAt { get; set; }
        public bool IsVisible { get; set; } = true;
    }

    public enum ToastType
    {
        Success,
        Error,
        Info,
        Warning
    }
    #endregion

    public void Dispose()
    {
        ThemeState.OnChange -= OnThemeChanged;
        AppSettings.OnChange -= OnSettingsChanged;
        toastCleanupTimer?.Dispose();
    }
}

<style>
    /* Floating Animation Effects */
    @@keyframes float {
        0%, 100% { transform: translateY(0) translateX(0); }
        25% { transform: translateY(-20px) translateX(10px); }
        50% { transform: translateY(-10px) translateX(-10px); }
        75% { transform: translateY(-30px) translateX(5px); }
    }

    @@keyframes float-slow {
        0%, 100% { transform: translateY(0) translateX(0) scale(1); }
        50% { transform: translateY(-40px) translateX(20px) scale(1.1); }
    }

    @@keyframes float-slower {
        0%, 100% { transform: translateY(0) translateX(0) scale(1); }
        50% { transform: translateY(-60px) translateX(-30px) scale(1.15); }
    }

    @@keyframes gradient-slow {
        0%, 100% { opacity: 0.3; }
        50% { opacity: 0.6; }
    }

    .animate-float {
        animation: float 8s ease-in-out infinite;
    }

    .animate-float-slow {
        animation: float-slow 12s ease-in-out infinite;
    }

    .animate-float-slower {
        animation: float-slower 15s ease-in-out infinite;
    }

    .animate-gradient-slow {
        animation: gradient-slow 8s ease-in-out infinite;
    }

    /* Smooth fade-in animations */
    @@keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @@keyframes slide-down {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @@keyframes slide-up {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in {
        animation: fade-in 1s ease-out;
    }

    .animate-slide-down {
        animation: slide-down 0.8s ease-out;
    }

    .animate-slide-up {
        animation: slide-up 0.8s ease-out;
    }

    .animate-fade-in-up {
        animation: slide-up 1s ease-out;
    }

    /* Hover Effects */
    .hover-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    /* Gradient Text Effect */
    .gradient-text {
        background-size: 200% auto;
        animation: gradient-shift 3s linear infinite;
    }

    @@keyframes gradient-shift {
        0%, 100% { background-position: 0% center; }
        50% { background-position: 100% center; }
    }

    /* Toast Slide-in Animation */
    @@keyframes toast-slide-in {
        from {
            opacity: 0;
            transform: translateX(100%);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .toast-slide-in {
        animation: toast-slide-in 0.3s ease-out;
    }

    /* Spinner Animation */
    @@keyframes spin {
        to { transform: rotate(360deg); }
    }

    .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(0, 0, 0, 0.1);
        border-left-color: currentColor;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
</style>

<script>
    window.scrollToSection = function(sectionId) {
        const element = document.getElementById(sectionId);
        if (element) {
            element.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    };
</script>